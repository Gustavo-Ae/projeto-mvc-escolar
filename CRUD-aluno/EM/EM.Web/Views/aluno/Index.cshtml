@model IEnumerable<EM.Domain.Model.Aluno>
@using System.Globalization;
@using EM.Domain.Enums;
@{
    ViewData["Title"] = "Index";
}


@if (TempData["MensagemAlerta"] != null)
{
    <div class="alert alert-warning" role="alert">
        @TempData["MensagemAlerta"]
    </div>
}

<div class="container pt-3">
    <div class="d-flex justify-content-between">
        <h1>Tabela de Alunos</h1>

        <p>
            <a asp-action="Create" class="btn btn-primary">👨‍🎓 Adicionar Aluno</a>
        </p>

    </div>

    <hr />

    <div>
        <form asp-action="Index">
            <strong>Opções de busca: </strong>
            <input type="radio" name="opcaoBusca" value="matricula"> Matricula
            <input type="radio" name="opcaoBusca" value="nome"> Nome
            <div class="input-group mb-3">
                <input type="text" name="texto" class="w-50 rounded" placeholder="Matrícula ou nome do aluno..." id="input-busca" required>
                <button type="submit" class="btn btn-primary" id="btn-busca">Buscar</button>
            </div>
        </form>
    </div>

     <section class="table-responsive">

        @if (Model != null && Model.Any())
        {
        <table class="table table-dark text-center">
                <thead class="thead-dark">
                    <tr>
                        <th>
                            @Html.DisplayNameFor(model => model.Matricula)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Nome)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Sexo)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Nascimento)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.CPF)
                        </th>
                        <th>
                            Opções
                        </th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var aluno in Model)
                    {
                        <tr>
                            <td>
                                @Html.DisplayFor(modelItem => aluno.Matricula)
                            </td>
                            <td class="text-start">
                                @Html.DisplayFor(modelItem => aluno.Nome)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => aluno.Sexo)
                            </td>
                            <td>
                                @aluno.Nascimento.ToString("dd/MM/yyyy")
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => aluno.CPF)
                            </td>
                            <td>
                                <a class="btn btn-primary" href="@Url.Action("Editar", "Aluno", new {@matricula=@aluno.Matricula})">✏️ Editar</a>  |
                                <a class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#modal-excluir" data-bs-whatever="@aluno.Matricula, @aluno.Nome, @aluno.CPF, @aluno.Nascimento.ToString("dd/MM/yyyy"), @aluno.Sexo">🗑️ Excluir</a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
        else
        {
            <div class="alert alert-dark" role="alert">
                🚩 Nenhum aluno cadastrado
            </div>
        }

        </section>
     

</div>

@*modal*@
<div class="modal fade" id="modal-excluir" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Você tem certeza que quer excluir esse aluno?</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>
                    <b>Matricula:</b> 
                    <span id="modal-matricula"></span>
                </p>
                <p>
                    <b>Nome:</b> 
                    <span id="modal-nome"></span>
                </p>
                 <p>
                    <b>CPF:</b> 
                    <span id="modal-cpf"></span>
                </p>
                <p>
                    <b>Nascimento:</b>
                    <span id="modal-nascimento"></span>
                </p>
                <p>
                    <b>Sexo:</b>
                    <span id="modal-sexo"></span>
                </p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">⬅️ Voltar</button>
                <a class="btn btn-danger" role="button" id="btn-modalExcluir">🗑️Excluir</a>
            </div>
        </div>
    </div>
</div>


